
#' Day 2 Practicing wrangling and ggplot2
install.packages("janitor")
#' load libraries
library(tidyverse)
library(janitor)
library(gtsummary)

#' import data
veal <- read_csv("data/Marcato_2021_immunity.csv") %>%
  clean_names() %>%
  mutate(bilirubin_1 = as.numeric(bilirubin_1),
         cortisol_1 = as.numeric(cortisol_1),
         timepoint = factor(timepoint, 
                            levels = c("CC",
                                       "T0",
                                       "T4",
                                       "T24",
                                       "T48",
                                       "Week 1",
                                       "Week 3",
                                       "Week 5")))
unique(veal$timepoint)
levels(veal$timepoint)
summary(veal)
glimpse(veal)

table(veal$timepoint)

veal %>%
  filter(timepoint== "CC") %>%
  group_by(batch, diet, duration, type) %>%
  summarise(count = n()) %>%
  pivot_wider(names_from = batch, values_from=count)

 veal %>%
   group_by(eartag, timepoint) %>%
   summarise(count = n()) %>%
   pivot_wider(names_from = timepoint, values_from = count)
#' Exploratory plots
 ggplot(veal, aes(x = timepoint, y = cortisol_1, col=diet))+
   geom_point()
 
 ggplot(veal, aes(x = timepoint, y = cortisol_1, col=diet))+
   geom_point() +
   geom_line(aes(group = eartag))

 ggplot(veal, aes(x = timepoint, y = cortisol_1, col=diet))+
   #geom_point()+
   geom_smooth(aes(group = diet))+
   facet_grid(type~duration)
 
 ggplot(veal, aes(x = timepoint, y = cortisol_1, 
                  col=as.factor(duration)))+
   #geom_point()+
   geom_smooth(aes(group = diet))+
   facet_grid(type~diet)

 veal %>%
   group_by(eartag, animal) %>%
   summarise(count = n()) %>%
   filter(count > 0)
 