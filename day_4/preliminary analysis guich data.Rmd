---
title: "Preliminary look at guich data"
author: "T. Neeman"
date: "2022-11-04"
output: word_document
---
These data come from a bigger experiment examining the how maternal investment in skinks may affect their offspring. This is a feeding experiment on skinks which is looking at how maternal investment in an egg laying species may affect the growth and behavior of the offspring.  The experiment was carried out on the same species of skink at 3x temperature treatments (23, 28, 32). There was also x2 yolk treatments: a control and the removal of approximately 16% of the yolk. In this data set the skinks were given crickets (usually 30) and the number of crickets eaten was recorded at day 2, 4 and 6. 

A prediction may be that those with yolk removed may undergo compensatory growth , and this may require more food to fuel this growth. Also, at higher temperatures the skink's metabolism increases (ectotherms), which also may require more food to fuel. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Set up libraries
```{r message = FALSE}
library(tidyverse)
library(lmerTest)
library(ggResidpanel)
library(emmeans)
```

Import data
```{r}
guich <- read_csv("data/guich_feed_data.csv", show_col_types = FALSE)
glimpse(guich)
```

How many skinks in each treatment?
```{r}
guich %>%
  group_by(yolk_trt, temp_trt) %>%
  summarise(count = n())
```

There are 2 temperature treatments (23/28) and 2 yolk treatments (C/A).

Have a look at the trial data over time. How much does each lizard weigh and how many crickets have they eaten? Colour by treatment (Yolk = C/A, Temp = 23/28).
Make sure to remove the yolk (=NA) treatment.
```{r}
eat_mass <- guich %>%
  filter(!is.na(yolk_trt)) %>%
  select(lizard_ID, yolk_trt, temp_trt, 
         trial1_mass, crickets_eaten1,
         trial2_mass, crickets_eaten2,
         trial3_mass, crickets_eaten3) %>%
  rename(trial1_crickets = "crickets_eaten1",
         trial2_crickets = "crickets_eaten2",
         trial3_crickets = "crickets_eaten3") %>%
  pivot_longer(cols = 4:9,
               names_to = c("trial","measure"),
               names_sep = "_",
               values_to = "value") %>%
  pivot_wider(names_from = "measure", values_from = "value")
```




Some exploratory plots
```{r}
ggplot(eat_mass, aes(x = trial, y = mass, col = interaction(yolk_trt, temp_trt)))+
  geom_point()+
  geom_line(aes(group = lizard_ID))+
  facet_grid(yolk_trt ~ temp_trt)
```

Crickets eaten
```{r}
eat_mass %>%
  filter(!is.na(yolk_trt)) %>%
ggplot(aes(x = trial, y = crickets, col = interaction(yolk_trt, temp_trt)))+
  geom_point()+
  geom_line(aes(group = lizard_ID))+
  facet_grid(yolk_trt ~ temp_trt)
```
What is the relationship between crickets eaten and mass (same trial)?
```{r}
eat_mass %>%
ggplot(aes(x = crickets, y = mass))+
  geom_point(aes(col = interaction(yolk_trt, temp_trt)))+
  geom_smooth(method = "lm")+
  facet_wrap(~trial)
```

Does skink food intake depend upon treatment (yolk or temperature)?
```{r}
model1 <- lmer(crickets~yolk_trt*temp_trt + (1|trial)+ (1|lizard_ID), data = eat_mass)
anova(model1)
```

Assess model fit.
```{r}
resid_panel(model1)
```
There is insufficient evidence of an effect of treatment. Obtain estimated modelled means from emmeans() function.
```{r}
emmeans(model1, ~yolk_trt*temp_trt)
```

