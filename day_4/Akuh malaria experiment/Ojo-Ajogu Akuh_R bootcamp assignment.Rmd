---
title: "R boot camp assignment"
author: "Ojo-Ajogu Akuh"
date: "`r Sys.Date()`"
output: html_document
---

Heitmeier et al., 2019 investigated some compounds for their ability to kill malaria parasite and found a compound (they called wu-1) as a potential drug for fighting malaria. The compound  affects the ability of the parasite to get sugar which it needs to survive.

# Library import
```{r}
library(tidyverse)
library(readxl)
library(janitor)
library(gtsummary)
library(ggsignif)
```

# Data import
```{r}
Drug <- read_xlsx("Data/pone.0216457.s004.xlsx", sheet = 3) %>% 
  clean_names()%>% 
  mutate(sd=c(1.07,1.86,1.85,1.09))

glimpse(Drug)
```

# Data visualization
```{r}
ggplot(Drug,aes(y=ic50, x=drug, fill=drug))+geom_bar(stat = "identity", width = 0.4)+
  geom_errorbar(aes(ymin=ic50-sd, ymax=ic50+sd), width=.2)+
  ylab("50% inhibitory concentration")+
  xlab("Drug candidates")
```
This bar graph shows the ability of the selected drug candidates to inhibit the growth of malaria parasite by affecting something that the parasite uses to transport sugar (called pf-HT). Wu-5 inhibit parasite growth more at low concentration than the others followed by Wu-2, Wu-1 and then Wu-3 in that order.

## Data import and wrangling for figure 2
```{r}
Fig2 <- read_xlsx("Data/pone.0216457.s004.xlsx", sheet = "Fig 2", skip = 1) %>%
  clean_names() %>% 
  rename(mean_1=ave_5m_mwu_1,
          mean_2=ave_5m_mwu_2,
         mean_3=ave_10m_mwu_3,
         mean_5=ave_2_5m_mwu_5,
         mean_cb=ave_200m_mcb,
         sem_1=sem_wu_1,
         sem_2=sem_wu_2,
         sem_3=sem_wu_3,
         sem_5=sem_wu_5,
         sem_cb=sem_cb) %>%
   pivot_longer(cols = 2:11,
               names_to = c("stat","Drug"),
               names_sep = "_",
               values_to = "DG_Uptake") %>% 
  pivot_wider(names_from = "stat",
              values_from = "DG_Uptake") %>% 
  mutate(Drug=factor(Drug, labels = c("5μMWU-1",
                                      "5μMWU-2",
                                    "10μMWU-3",
                                    "2,5μMWU-5",
                                  "200μMCB")))
```

## Visualization of figure 2
```{r}
ggplot(Fig2,aes(y=mean, x=Drug, fill=transporters))+geom_col(position = "dodge")+
  geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem),width=.2,position = position_dodge(.9))+
  ylab("2-DG Uptake (% Inhbition)")+
  xlab("Drug candidates")+
  geom_hline(yintercept = 50)
```



# Figure 2
```{r}
ggplot(Fig2, aes(Drug_candidates, DG_Uptake, fill=Transporters)) + geom_col(position = "dodge")+
   ylab("2-DG Uptake (% Inhibition")+
  xlab("Glucose transporters")
```

## Data visualization
```{r}
Drug_a <- Drug %>% 
  pivot_longer(cols = 3:7,
               names_prefix = "percent_inhibition_",
               names_to = "Transporters",
               values_to = "Inhibition") 

Drug_b <- Drug %>% 
  pivot_longer(cols = 3:7,
               names_prefix = "percent_inhibition_",
               names_to = "Transporters",
               values_to = "Inhibition") %>% 
  filter(!(Transporters)==c("pf_ht"))

ggplot(Drug_a, aes(Drug_candidates, 2-DG Uptake, col=Transporters)) + geom_point()+
  geom_line(aes(group=drug))+
  ylab("2-DG Uptake (% Inhibition)")+
  xlab("Glucose transporters")
```
```{r}
ggplot(Drug_a, aes(Transporters, Inhibition, fill=drug)) + geom_bar(stat = "identity", width = 0.3) +
   ylab("Inhibition by drug candidate")+
  xlab("Glucose transporters")
```
```{r}
ggplot(Drug_a, aes(drug, Inhibition, fill=Transporters)) + geom_bar(stat = "identity", width = 0.4)+
    ylab("Inhibition by drug candidate")+
  xlab("Drug candidate")
```
```{r}
ggplot(Drug_b, aes(drug, Inhibition, fill=Transporters)) + geom_bar(stat = "identity", width = 0.5)+
    ylab("Inhibition by drug candidate")+
  xlab("Drug candidate")
```


# Tables
```{r}
T1 <- Drug_a %>% 
  group_by(drug) %>% 
  summarise(count=n(),  mean_inhibition=mean(Inhibition))

table(T1)
tbl_summary(T1)

tbl_summary(Drug_a)

Drug_a$ic50 <- cut(Drug_a$ic50, breaks = c(0,2,6,10),
                  labels = c("Very good", "Good", "Bad"))

f1 <- Drug_a %>% 
  group_by(ic50, drug) %>% 
  summarise(count=n(), mean_inhibition=mean(Inhibition))

tbl_summary(f1)

f1$Inhibition_group <- cut(f1$mean_inhibition,breaks = c(0,12,70),
                           labels = c("specific", "non-specific"))
```

# Visualizing the grouped ic50
```{r}
ggplot(f1,aes(drug,mean_inhibition,fill=ic50))+geom_bar(stat = "identity", width = 0.5)+
  ylab("Inhibition of hosts' sugar transporters")+
  xlab("Drug candidates")+
  facet_wrap(~Inhibition_group)
```


A good drug candidate should not only kill the parasite at low concentration but should be highly selective against host cells. In the above data visualization exercise, I have showed that though Wu-5 is the one that kills the parasite at the lowest concentration among the drug candidates, it is not very specific for the parasite and can also target substances used by the host cells to transport sugar. Hence, Wu-1 was selected because it does not target host sugar transporters